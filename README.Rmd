---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-"
)
options(knitr.table.format = 'markdown')
```

# mmetrics

[![Travis-CI Build Status](https://api.travis-ci.com/shinichi-takayanagi/mmetrics.svg?branch=master)](https://travis-ci.com/shinichi-takayanagi/mmetrics)
[![CRAN_Status_Badge](https://www.r-pkg.org/badges/version/mmetrics)](https://cran.r-project.org/package=mmetrics)


## Installation

```{r gh-installation, eval = FALSE}
install.packages("mmetrics")

# Or the development version from GitHub:
# install.packages("devtools")
devtools::install_github("shinichi-takayanagi/mmetrics")
```

## Example

First, we create dummy data for this example.
```{r}
library("mmetrics")
# Dummy data
df <- data.frame(
  gender = rep(c("M", "F"), 5),
  age = (1:10)*10,
  cost = c(51:60),
  impression = c(101:110),
  click = c(0:9)*3,
  conversion = c(0:9)
)

head(df)
```

As a next step, we define metrics to evaluate using `rlang::quos`. 
```{r}
# Example metrics
metrics <- rlang::quos(
  cost = sum(cost),
  ctr  = sum(click)/sum(impression)
)
```

Call `mmetrics::add()` with grouping key (here `gender`) then we will get new `data.frame` with defined metrics.
```{r}
mmetrics::add(df, gender, metrics = metrics)
```

We can also use multiple grouping keys.
```{r}
mmetrics::add(df, gender, age, metrics = metrics)
```

If we do not specify any grouping keys, `mmetrics::add()` behave like `dplyr::mutate()` as a default option.
```{r}
mmetrics::add(df, metrics = metrics)
```

If we want to summarize all data, change `summarize` argument to `TRUE`.
```{r}
mmetrics::add(df, metrics = metrics, summarize=TRUE)
```
